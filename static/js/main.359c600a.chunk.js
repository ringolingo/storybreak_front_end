(this["webpackJsonpstorybreak-front-end"]=this["webpackJsonpstorybreak-front-end"]||[]).push([[0],{117:function(t,e,n){},230:function(t,e,n){},231:function(t,e,n){},235:function(t,e,n){},236:function(t,e,n){"use strict";n.r(e);var c=n(1),o=n(0),a=n.n(o),r=n(25),i=n.n(r),s=(n(117),n(32)),l=n(33),u=n.n(l),d=n(51),j=n(39),b=n(11),h=n(21),f=n(13),O=n.n(f),p=n(12),g=n(18),m=n(10),y=(n(230),function(t){var e=t.card,n=t.showCard;return Object(c.jsx)("div",{onDoubleClick:function(){n(e)},className:"card",children:Object(c.jsx)("div",{className:"card-body",children:Object(c.jsx)("p",{children:e.card_summary})})})}),x=(n(231),function(t){var e=t.currentStoryId,n=t.backToDesk,a=t.addSceneCallback,r=Object(o.useState)([]),i=Object(b.a)(r,2),l=i[0],u=i[1],d=Object(o.useState)(!1),h=Object(b.a)(d,2),f=h[0],x=h[1],k=Object(o.useState)(!1),v=Object(b.a)(k,2),_=v[0],C=v[1],S=Object(o.useState)({id:null,card_summary:"",location:null,content_blocks:"",story:null,entity_key:""}),w=Object(b.a)(S,2),N=w[0],E=w[1];Object(o.useEffect)((function(){T()}),[]);var T=function(){O.a.get("api/scenes/?story=".concat(e)).then((function(t){u(t.data)})).catch((function(t){return console.log(t.response.data)}))},L=function(t){console.log("popoutcard");var e={id:t.id,card_summary:t.card_summary,location:t.location,content_blocks:t.content_blocks,story:t.story,entity_key:t.entity_key};E(e),C(!0)},F=function(){x(!1),C(!1),E({id:null,card_summary:"",location:null,content_blocks:[],story:null,entity_key:""})},M=l.map((function(t,e){return t.story=parseInt(t.story),Object(c.jsx)(y,{showCard:L,card:t},t.id)})),B=function(){var t=Math.random().toString(36).substring(2,10),n={card_summary:N.card_summary,location:l.length,story:e,entity_key:t};O.a.post("/api/scenes/",n).then((function(t){return console.log(t.data)})).catch((function(t){return console.log(t.response)}));var c=Object(j.a)(l);c.push(n),u(c),F(),a(n)},G=function(t){var n={id:N.id,card_summary:t.target.value,location:N.location,content_blocks:N.content_blocks,story:e,entity_key:N.entity_key};E(n)},I=function(){O.a.put("api/scenes/".concat(N.id,"/"),N).then((function(t){return console.log(t.data)})).catch((function(t){return console.log(t.response.data)}));var t=[];l.forEach((function(e){e.id===N.id?t.push(N):t.push(e)})),u(t),F()},A=function(){var t=0,e=[];l.forEach((function(n,c){if(n.id!==N.id){var o=Object(s.a)({},n);o.location=c-t,e.push(o),O.a.put("api/scenes/".concat(o.id,"/"),o).then((function(t){return console.log(t.data)})).catch((function(t){return console.log(t.response.data)}))}else t++,O.a.put("api/scenes/".concat(N.id,"/"),Object(s.a)(Object(s.a)({},n),{},{location:null})).then((function(t){return console.log(t.data)})).catch((function(t){return console.log(t.response.data)}))})),u(e),F()},D=function(t){if(N.location+t>=l.length||N.location+t<0)F();else{I();var e=Object(j.a)(l);e.splice(N.location,1),e.splice(N.location+t,0,N);var n=e.map((function(t,e){var n=Object(s.a)({},t);return n.location=e,O.a.put("api/scenes/".concat(n.id,"/"),n).then((function(t){return console.log(t.data)})).catch((function(t){return console.log(t.response.data)})),n}));u(n),E({id:N.id,card_summary:N.card_summary,location:N.location+1,content_blocks:N.content_blocks,story:N.story,entity_key:N.entity_key})}};return Object(c.jsxs)("div",{className:"corkboard__wall",children:[Object(c.jsx)("button",{className:"btn btn-block story-list__title-change",onClick:n,children:"Go To Writing Desk"}),Object(c.jsx)("div",{className:"corkboard__frame rounded p-5 d-flex justify-content-center align-items-center",children:Object(c.jsx)("div",{className:"corkboard__board d-flex flex-wrap justify-content-center p-2",children:M})}),Object(c.jsx)("div",{className:"corkboard__button-bar d-flex justify-content-center",children:Object(c.jsx)("button",{onClick:function(){x(!0)},className:"btn btn-medium btn-primary",children:"Add New Card"})}),Object(c.jsxs)(p.a,{show:_,onHide:F,animation:!1,backdrop:"static",centered:!0,children:[Object(c.jsx)(p.a.Body,{children:Object(c.jsx)(m.a,{children:Object(c.jsxs)(m.a.Group,{children:[Object(c.jsx)(m.a.Label,{children:"Scene Summary"}),Object(c.jsx)(m.a.Control,{as:"textarea",value:N.card_summary,onChange:G})]})})}),Object(c.jsxs)(p.a.Footer,{children:[Object(c.jsx)(g.a,{variant:"secondary",onClick:F,children:"Close"}),Object(c.jsx)(g.a,{variant:"primary",onClick:I,children:"Save Changes"}),0===N.location?null:Object(c.jsx)(g.a,{variant:"info",onClick:function(){return D(-1)},children:"Move Scene Earlier"}),N.location===l.length-1?null:Object(c.jsx)(g.a,{variant:"info",onClick:function(){return D(1)},children:"Move Scene Later"}),Object(c.jsx)(g.a,{variant:"danger",onClick:A,children:"Delete Scene"})]})]}),Object(c.jsxs)(p.a,{show:f,onHide:F,animation:!1,backdrop:"static",centered:!0,children:[Object(c.jsx)(p.a.Body,{children:Object(c.jsx)(m.a,{children:Object(c.jsxs)(m.a.Group,{children:[Object(c.jsx)(m.a.Label,{children:"What's a quick summary of what happens in this scene?"}),Object(c.jsx)(m.a.Control,{as:"textarea",value:N.card_summary,onChange:G})]})})}),Object(c.jsxs)(p.a.Footer,{children:[Object(c.jsx)(g.a,{variant:"secondary",onClick:F,children:"Close"}),Object(c.jsx)(g.a,{variant:"primary",onClick:B,children:"Save New Scene"})]})]})]})}),k=n(53),v=function(t){var e=t.setUser,n=function(t){var e=1e3*(t.tokenObj.expires_in||3300),n=function(){var c=Object(d.a)(u.a.mark((function c(){var o;return u.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,t.reloadAuthResponse();case 2:o=c.sent,e=1e3*(o.expires_in||3300),console.log("newAuthResponse:",o),console.log("new auth token",o.id_token),setTimeout(n,e);case 7:case"end":return c.stop()}}),c)})));return function(){return c.apply(this,arguments)}}();setTimeout(n,e)};return Object(c.jsx)("div",{children:Object(c.jsx)(k.GoogleLogin,{clientId:"195198641210-o0725v1k4223tg8v6t5qep3dd463f5q6.apps.googleusercontent.com",buttonText:"Login",onSuccess:function(t){console.log("[Login Success] currentUser:",t.profileObj);var c={id_token:t.getAuthResponse().id_token,email:t.profileObj.email,first_name:t.profileObj.givenName,last_name:t.profileObj.familyName};O.a.post("api/users/",c).then((function(t){e(t.data)})).catch((function(t){return console.log(t.response)})),n(t)},onFailure:function(t){console.log("[Login Failed] response: ",t)},cookiePolicy:"single_host_origin",isSignedIn:!0})})},_=function(t){var e=t.setUser;return Object(c.jsx)("div",{children:Object(c.jsx)(k.GoogleLogout,{clientId:"195198641210-o0725v1k4223tg8v6t5qep3dd463f5q6.apps.googleusercontent.com",buttonText:"Logout",onLogoutSuccess:function(){alert("you have logged out"),e({id:null,email:"",first_name:"",last_name:""})}})})};n(235);var C=function(){var t=Object(o.useState)((function(){return h.EditorState.createEmpty()})),e=Object(b.a)(t,2),n=e[0],a=e[1],r=Object(o.useState)([]),i=Object(b.a)(r,2),l=i[0],f=i[1],y=Object(o.useState)(null),k=Object(b.a)(y,2),C=k[0],S=k[1],w=Object(o.useState)(""),N=Object(b.a)(w,2),E=N[0],T=N[1],L=Object(o.useState)(!1),F=Object(b.a)(L,2),M=F[0],B=F[1],G=Object(o.useState)(""),I=Object(b.a)(G,2),A=I[0],D=I[1],q=Object(o.useState)(!1),R=Object(b.a)(q,2),U=R[0],W=R[1],H=Object(o.useState)(!1),J=Object(b.a)(H,2),P=J[0],K=J[1],z=Object(o.useState)(!1),Q=Object(b.a)(z,2),V=Q[0],X=Q[1],Y=Object(o.useState)(""),Z=Object(b.a)(Y,2),$=Z[0],tt=Z[1],et=Object(o.useState)(""),nt=Object(b.a)(et,2),ct=(nt[0],nt[1],Object(o.useState)(null)),ot=Object(b.a)(ct,2),at=(ot[0],ot[1],Object(o.useState)({id:null,email:"",first_name:"",last_name:""})),rt=Object(b.a)(at,2),it=rt[0],st=rt[1];Object(o.useEffect)((function(){lt()}),[]),Object(o.useEffect)((function(){lt()}),[it]);var lt=function(){console.log("getStories is pulling stories for user number",it.id),O.a.get("/api/stories/?user=".concat(it.id)).then((function(t){f(t.data),console.log("getstories response")})).catch((function(t){return console.log(t.response)}))},ut=function(t){st(t),lt(),console.log("usercallback is running")},dt=function(t){S(t.target.id),T(t.target.title),jt(t.target.id)},jt=function(t){O.a.get("/api/stories/".concat(t)).then((function(t){bt(t.data.draft_raw)})).catch((function(t){console.log(t.response),S(null),T(null)}))},bt=function(t){var e=JSON.parse(t),n=Object(h.convertFromRaw)(e),c=h.EditorState.createWithContent(n);a(c)},ht=function(){S(null),T(""),lt()},ft=function(){K(!0)},Ot=function(){K(!1)},pt=function(t){D(t.target.value)},gt=function(){""!==A?(O.a.post("/api/stories/",{title:A,draft_raw:'{"blocks":[],"entityMap":{}}',user:it.id}).then((function(t){S(t.data.id),T(t.data.title);var e=Object(j.a)(l);e.push(t.data),f(e)})).catch((function(t){return console.log(t)})),Ot(),D("")):Ot()},mt=l.map((function(t,e){return Object(c.jsx)("button",{className:"btn story-list__title",id:t.id,onClick:dt,title:t.title,children:t.title},e)})),yt=function(){var t=l.map((function(t){if(t.id!==C)return t}));f(t),O.a.delete("/api/stories/".concat(C,"/")).then((function(t){return console.log(t.data)})).catch((function(t){return console.log(t)})),ht()},xt=function(t){a(t)},kt=function(t,e){var n=e.getCurrentContent(),c=Object(h.convertToRaw)(n),o={title:t,draft_raw:JSON.stringify(c),user:it.id};console.log("savework"),O.a.put("/api/stories/".concat(C,"/"),o).then((function(t){return console.log(t.data)})).catch((function(t){return console.log(t.response)}))},vt=function(){kt(E,n)},_t=function(t){console.log("addscenebreaks");var e=n.getCurrentContent(),c=n,o=c.getSelection();Object(h.convertToRaw)(e).blocks.length>1&&(e=(c=Ct()).getCurrentContent(),o=c.getSelection());var r=t.entity_key;e.createEntity("SCENE","IMMUTABLE",r);var i=e.getLastCreatedEntityKey(),s=h.Modifier.insertText(e,o,"***",null,i),l=h.EditorState.push(c,s,"insert-characters");return a(l),Ct(l)},Ct=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,e=t.getCurrentContent(),c=t.getSelection(),o=h.Modifier.splitBlock(e,c),r=h.EditorState.push(t,o,"split-block");return a(r),r},St=function(){tt(""),X(!0)},wt=function(){X(!1)},Nt=function(t){tt(t.target.value)},Et=function(){var t=Math.random().toString(36).substring(2,10),e={card_summary:$,story:C,entity_key:t};O.a.post("/api/scenes/",e).then((function(t){return console.log(t.data)})).catch((function(t){return console.log(t.response)})),wt(),Tt(e)},Tt=function(){var t=Object(d.a)(u.a.mark((function t(e){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_t(e);case 2:return n=t.sent,t.next=5,kt(E,n);case 5:t.sent;case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Lt=function(){B(!0)},Ft=function(){B(!1),D("")},Mt=function(t){D(t.target.value)},Bt=function(){kt(A,n),T(A);var t=l.map((function(t){if(t.id==C){var e=Object(s.a)({},t);return t.title=A,e}return t}));f(t),Ft()},Gt=function(){vt(),W(!0)},It=function(){jt(C),W(!1)};return Object(c.jsxs)("div",{children:[Object(c.jsxs)("div",{className:"d-flex justify-content-between",children:[C?Object(c.jsx)("div",{children:Object(c.jsx)("button",{className:"btn btn-block story-list__title-change",onClick:ht,children:"Choose A Different Story"})}):null,C?Object(c.jsx)("h3",{children:E}):null,it.email?Object(c.jsx)(_,{setUser:ut}):Object(c.jsx)(v,{setUser:ut})]}),C?U?Object(c.jsx)(x,{currentStoryId:C,backToDesk:It,addSceneCallback:Tt}):Object(c.jsxs)("div",{className:"writing-desk__desk",children:[Object(c.jsx)("button",{className:"btn btn-block story-list__title-change",onClick:Gt,children:"Go To Story Board"}),Object(c.jsx)("div",{className:"writing-desk__editor container border border-dark rounded w-75 h-75",children:Object(c.jsx)(h.Editor,{editorState:n,onChange:xt,spellCheck:!0})}),Object(c.jsxs)("div",{className:"writing-desk__button-bar d-flex flex-row justify-content-center",children:[Object(c.jsx)("button",{onClick:vt,className:"btn btn-primary rounded m-1",children:"Save"}),Object(c.jsx)("button",{onClick:St,className:"btn btn-secondary rounded m-1",children:"Add New Scene"}),Object(c.jsx)("button",{onClick:Lt,className:"btn btn-secondary rounded m-1",children:"Change Title"}),Object(c.jsx)("button",{onClick:yt,className:"btn btn-danger rounded m-1",children:"Delete Story"})]}),Object(c.jsxs)(p.a,{show:M,onHide:Ft,animation:!1,backdrop:"static",centered:!0,children:[Object(c.jsx)(p.a.Body,{children:Object(c.jsx)(m.a,{children:Object(c.jsxs)(m.a.Group,{children:[Object(c.jsx)(m.a.Label,{children:"New Title"}),Object(c.jsx)(m.a.Control,{as:"textarea",value:A,onChange:Mt})]})})}),Object(c.jsxs)(p.a.Footer,{children:[Object(c.jsx)(g.a,{variant:"secondary",onClick:Ft,children:"Close"}),Object(c.jsx)(g.a,{variant:"primary",onClick:Bt,children:"Save New Title"})]})]})]}):Object(c.jsxs)("div",{className:"story-list",children:[Object(c.jsx)("h3",{className:"story-list__header",children:"What would you like to work on today?"}),mt,Object(c.jsx)("button",{className:"btn story-list__title btn-primary",onClick:ft,children:"Start A New Story"})]}),Object(c.jsxs)(p.a,{show:P,onHide:Ot,animation:!1,backdrop:"static",centered:!0,children:[Object(c.jsx)(p.a.Body,{children:Object(c.jsx)(m.a,{children:Object(c.jsxs)(m.a.Group,{children:[Object(c.jsx)(m.a.Label,{children:"What do you want the title of your story to be?"}),Object(c.jsx)(m.a.Control,{as:"textarea",value:A,onChange:pt})]})})}),Object(c.jsx)(p.a.Footer,{children:Object(c.jsx)(g.a,{variant:"primary",onClick:gt,children:"Set Title"})})]}),Object(c.jsxs)(p.a,{show:V,onHide:wt,animation:!1,backdrop:"static",centered:!0,children:[Object(c.jsx)(p.a.Body,{children:Object(c.jsx)(m.a,{children:Object(c.jsxs)(m.a.Group,{children:[Object(c.jsx)(m.a.Label,{children:"What's a quick summary of what happens in this scene?"}),Object(c.jsx)(m.a.Control,{as:"textarea",value:$,onChange:Nt})]})})}),Object(c.jsx)(p.a.Footer,{children:Object(c.jsx)(g.a,{variant:"primary",onClick:Et,children:"Make New Scene"})})]})]})},S=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,238)).then((function(e){var n=e.getCLS,c=e.getFID,o=e.getFCP,a=e.getLCP,r=e.getTTFB;n(t),c(t),o(t),a(t),r(t)}))};i.a.render(Object(c.jsx)(a.a.StrictMode,{children:Object(c.jsx)(C,{})}),document.getElementById("root")),S()}},[[236,1,2]]]);
//# sourceMappingURL=main.359c600a.chunk.js.map