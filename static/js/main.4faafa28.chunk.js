(this["webpackJsonpstorybreak-front-end"]=this["webpackJsonpstorybreak-front-end"]||[]).push([[0],{117:function(t,e,n){},230:function(t,e,n){},231:function(t,e,n){},235:function(t,e,n){},236:function(t,e,n){"use strict";n.r(e);var c=n(1),o=n(0),a=n.n(o),r=n(25),i=n.n(r),s=(n(117),n(32)),l=n(33),u=n.n(l),d=n(51),b=n(39),j=n(12),h=n(21),f=n(13),O=n.n(f),p=n(11),m=n(18),x=n(10),g=(n(230),function(t){var e=t.card,n=t.showCard;return Object(c.jsx)("div",{onDoubleClick:function(){n(e)},className:"card",children:Object(c.jsx)("div",{className:"card-body",children:Object(c.jsx)("p",{children:e.card_summary})})})}),y=(n(231),function(t){var e=t.currentStoryId,n=(t.backToDesk,t.addSceneCallback),a=Object(o.useState)([]),r=Object(j.a)(a,2),i=r[0],l=r[1],u=Object(o.useState)(!1),d=Object(j.a)(u,2),h=d[0],f=d[1],y=Object(o.useState)(!1),k=Object(j.a)(y,2),v=k[0],_=k[1],C=Object(o.useState)({id:null,card_summary:"",location:null,content_blocks:"",story:null,entity_key:""}),S=Object(j.a)(C,2),w=S[0],N=S[1];Object(o.useEffect)((function(){L()}),[]);var L=function(){O.a.get("api/scenes/?story=".concat(e)).then((function(t){l(t.data)})).catch((function(t){return console.log(t.response.data)}))},T=function(t){console.log("popoutcard");var e={id:t.id,card_summary:t.card_summary,location:t.location,content_blocks:t.content_blocks,story:t.story,entity_key:t.entity_key};N(e),_(!0)},E=function(){f(!1),_(!1),N({id:null,card_summary:"",location:null,content_blocks:[],story:null,entity_key:""})},F=i.map((function(t,e){return t.story=parseInt(t.story),Object(c.jsx)(g,{showCard:T,card:t},t.id)})),M=function(){var t=Math.random().toString(36).substring(2,10),c={card_summary:w.card_summary,location:i.length,story:e,entity_key:t};O.a.post("/api/scenes/",c).then((function(t){return console.log(t.data)})).catch((function(t){return console.log(t.response)}));var o=Object(b.a)(i);o.push(c),l(o),E(),n(c)},B=function(t){var n={id:w.id,card_summary:t.target.value,location:w.location,content_blocks:w.content_blocks,story:e,entity_key:w.entity_key};N(n)},G=function(){O.a.put("api/scenes/".concat(w.id,"/"),w).then((function(t){return console.log(t.data)})).catch((function(t){return console.log(t.response.data)}));var t=[];i.forEach((function(e){e.id===w.id?t.push(w):t.push(e)})),l(t),E()},I=function(){var t=0,e=[];i.forEach((function(n,c){if(n.id!==w.id){var o=Object(s.a)({},n);o.location=c-t,e.push(o),O.a.put("api/scenes/".concat(o.id,"/"),o).then((function(t){return console.log(t.data)})).catch((function(t){return console.log(t.response.data)}))}else t++,O.a.put("api/scenes/".concat(w.id,"/"),Object(s.a)(Object(s.a)({},n),{},{location:null})).then((function(t){return console.log(t.data)})).catch((function(t){return console.log(t.response.data)}))})),l(e),E()},A=function(t){if(w.location+t>=i.length||w.location+t<0)E();else{G();var e=Object(b.a)(i);e.splice(w.location,1),e.splice(w.location+t,0,w);var n=e.map((function(t,e){var n=Object(s.a)({},t);return n.location=e,O.a.put("api/scenes/".concat(n.id,"/"),n).then((function(t){return console.log(t.data)})).catch((function(t){return console.log(t.response.data)})),n}));l(n),N({id:w.id,card_summary:w.card_summary,location:w.location+1,content_blocks:w.content_blocks,story:w.story,entity_key:w.entity_key})}};return Object(c.jsxs)("div",{className:"corkboard__wall",children:[Object(c.jsx)("div",{className:"corkboard__frame rounded p-5 d-flex justify-content-center align-items-center",children:Object(c.jsx)("div",{className:"corkboard__board d-flex flex-wrap justify-content-center p-2",children:F})}),Object(c.jsx)("div",{className:"corkboard__button-bar d-flex justify-content-center",children:Object(c.jsx)("button",{onClick:function(){f(!0)},className:"btn btn-medium btn-primary",children:"Add New Card"})}),Object(c.jsxs)(p.a,{show:v,onHide:E,animation:!1,backdrop:"static",centered:!0,children:[Object(c.jsx)(p.a.Body,{children:Object(c.jsx)(x.a,{children:Object(c.jsxs)(x.a.Group,{children:[Object(c.jsx)(x.a.Label,{children:"Scene Summary"}),Object(c.jsx)(x.a.Control,{as:"textarea",value:w.card_summary,onChange:B})]})})}),Object(c.jsxs)(p.a.Footer,{children:[Object(c.jsx)(m.a,{variant:"secondary",onClick:E,children:"Close"}),Object(c.jsx)(m.a,{variant:"primary",onClick:G,children:"Save Changes"}),0===w.location?null:Object(c.jsx)(m.a,{variant:"info",onClick:function(){return A(-1)},children:"Move Scene Earlier"}),w.location===i.length-1?null:Object(c.jsx)(m.a,{variant:"info",onClick:function(){return A(1)},children:"Move Scene Later"}),Object(c.jsx)(m.a,{variant:"danger",onClick:I,children:"Delete Scene"})]})]}),Object(c.jsxs)(p.a,{show:h,onHide:E,animation:!1,backdrop:"static",centered:!0,children:[Object(c.jsx)(p.a.Body,{children:Object(c.jsx)(x.a,{children:Object(c.jsxs)(x.a.Group,{children:[Object(c.jsx)(x.a.Label,{children:"What's a quick summary of what happens in this scene?"}),Object(c.jsx)(x.a.Control,{as:"textarea",value:w.card_summary,onChange:B})]})})}),Object(c.jsxs)(p.a.Footer,{children:[Object(c.jsx)(m.a,{variant:"secondary",onClick:E,children:"Close"}),Object(c.jsx)(m.a,{variant:"primary",onClick:M,children:"Save New Scene"})]})]})]})}),k=n(53),v=function(t){var e=t.setUser,n=function(t){var e=1e3*(t.tokenObj.expires_in||3300),n=function(){var c=Object(d.a)(u.a.mark((function c(){var o;return u.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,t.reloadAuthResponse();case 2:o=c.sent,e=1e3*(o.expires_in||3300),console.log("newAuthResponse:",o),console.log("new auth token",o.id_token),setTimeout(n,e);case 7:case"end":return c.stop()}}),c)})));return function(){return c.apply(this,arguments)}}();setTimeout(n,e)};return Object(c.jsx)("div",{children:Object(c.jsx)(k.GoogleLogin,{clientId:"195198641210-o0725v1k4223tg8v6t5qep3dd463f5q6.apps.googleusercontent.com",buttonText:"Login",onSuccess:function(t){console.log("[Login Success] currentUser:",t.profileObj);var c={id_token:t.getAuthResponse().id_token,email:t.profileObj.email,first_name:t.profileObj.givenName,last_name:t.profileObj.familyName};O.a.post("api/users/",c).then((function(t){e(t.data)})).catch((function(t){return console.log(t.response)})),n(t)},onFailure:function(t){console.log("[Login Failed] response: ",t)},cookiePolicy:"single_host_origin",isSignedIn:!0,render:function(t){return Object(c.jsx)("button",{onClick:t.onClick,disabled:t.disabled,className:"btn btn-block",children:"Login with Google"})}})})},_=function(t){var e=t.setUser;return Object(c.jsx)("div",{children:Object(c.jsx)(k.GoogleLogout,{clientId:"195198641210-o0725v1k4223tg8v6t5qep3dd463f5q6.apps.googleusercontent.com",buttonText:"Logout",onLogoutSuccess:function(){alert("you have logged out"),e({id:null,email:"",first_name:"",last_name:""})},render:function(t){return Object(c.jsx)("button",{onClick:t.onClick,disabled:t.disabled,className:"btn btn-block",children:"Log Out"})},className:"btn btn-secondary google-log-btn"})})};n(235);var C=function(){var t=Object(o.useState)((function(){return h.EditorState.createEmpty()})),e=Object(j.a)(t,2),n=e[0],a=e[1],r=Object(o.useState)([]),i=Object(j.a)(r,2),l=i[0],f=i[1],g=Object(o.useState)(null),k=Object(j.a)(g,2),C=k[0],S=k[1],w=Object(o.useState)(""),N=Object(j.a)(w,2),L=N[0],T=N[1],E=Object(o.useState)(!1),F=Object(j.a)(E,2),M=F[0],B=F[1],G=Object(o.useState)(""),I=Object(j.a)(G,2),A=I[0],D=I[1],q=Object(o.useState)(!1),R=Object(j.a)(q,2),U=R[0],W=R[1],H=Object(o.useState)(!1),J=Object(j.a)(H,2),P=J[0],K=J[1],z=Object(o.useState)(!1),Q=Object(j.a)(z,2),V=Q[0],X=Q[1],Y=Object(o.useState)(""),Z=Object(j.a)(Y,2),$=Z[0],tt=Z[1],et=Object(o.useState)({id:null,email:"",first_name:"",last_name:""}),nt=Object(j.a)(et,2),ct=nt[0],ot=nt[1];Object(o.useEffect)((function(){at()}),[ct]);var at=function(){ct.id&&O.a.get("/api/stories/?user=".concat(ct.id)).then((function(t){f(t.data)})).catch((function(t){return console.log(t.response)}))},rt=function(t){S(t.target.id),T(t.target.title),it(t.target.id)},it=function(t){O.a.get("/api/stories/".concat(t)).then((function(t){st(t.data.draft_raw)})).catch((function(t){console.log(t.response),S(null),T(null)}))},st=function(t){var e=JSON.parse(t),n=Object(h.convertFromRaw)(e),c=h.EditorState.createWithContent(n);a(c)},lt=function(){S(null),T(""),at()},ut=function(){K(!0)},dt=function(){K(!1)},bt=function(t){D(t.target.value)},jt=function(){""!==A?(O.a.post("/api/stories/",{title:A,draft_raw:'{"blocks":[],"entityMap":{}}',user:ct.id}).then((function(t){S(t.data.id),T(t.data.title);var e=Object(b.a)(l);e.push(t.data),f(e)})).catch((function(t){return console.log(t)})),dt(),D("")):dt()},ht=l.map((function(t,e){return Object(c.jsx)("button",{className:"btn story-list__title",id:t.id,onClick:rt,title:t.title,children:t.title},e)})),ft=function(){var t=l.map((function(t){if(t.id!==C)return t}));f(t),O.a.delete("/api/stories/".concat(C,"/")).then((function(t){return console.log(t.data)})).catch((function(t){return console.log(t)})),lt()},Ot=function(t){a(t)},pt=function(t,e){var n=e.getCurrentContent(),c=Object(h.convertToRaw)(n),o={title:t,draft_raw:JSON.stringify(c),user:ct.id};console.log("savework"),O.a.put("/api/stories/".concat(C,"/"),o).then((function(t){return console.log(t.data)})).catch((function(t){return console.log(t.response)}))},mt=function(){pt(L,n)},xt=function(t){console.log("addscenebreaks");var e=n.getCurrentContent(),c=n,o=c.getSelection();Object(h.convertToRaw)(e).blocks.length>1&&(e=(c=gt()).getCurrentContent(),o=c.getSelection());var r=t.entity_key;e.createEntity("SCENE","IMMUTABLE",r);var i=e.getLastCreatedEntityKey(),s=h.Modifier.insertText(e,o,"***",null,i),l=h.EditorState.push(c,s,"insert-characters");return a(l),gt(l)},gt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,e=t.getCurrentContent(),c=t.getSelection(),o=h.Modifier.splitBlock(e,c),r=h.EditorState.push(t,o,"split-block");return a(r),r},yt=function(){tt(""),X(!0)},kt=function(){X(!1)},vt=function(t){tt(t.target.value)},_t=function(){var t=Math.random().toString(36).substring(2,10),e={card_summary:$,story:C,entity_key:t};O.a.post("/api/scenes/",e).then((function(t){return console.log(t.data)})).catch((function(t){return console.log(t.response)})),kt(),Ct(e)},Ct=function(){var t=Object(d.a)(u.a.mark((function t(e){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,xt(e);case 2:return n=t.sent,t.next=5,pt(L,n);case 5:t.sent;case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),St=function(){B(!0)},wt=function(){B(!1),D("")},Nt=function(t){D(t.target.value)},Lt=function(){pt(A,n),T(A);var t=l.map((function(t){if(t.id==C){var e=Object(s.a)({},t);return t.title=A,e}return t}));f(t),wt()},Tt=function(){mt(),W(!0)},Et=function(){it(C),W(!1)};return Object(c.jsxs)("div",{children:[C?Object(c.jsx)("h4",{className:"current-title-btn",children:L}):null,Object(c.jsxs)("div",{className:"d-flex justify-content-end main-options-nav",children:[C?U?Object(c.jsx)("button",{className:"btn btn-block",onClick:Et,children:"Go To Writing Desk"}):Object(c.jsx)("button",{className:"btn btn-block",onClick:Tt,children:"Go To Story Board"}):null,C?Object(c.jsx)("div",{children:Object(c.jsx)("button",{className:"btn btn-block story-list__title-change",onClick:lt,children:"Choose A Different Story"})}):null,ct.email?Object(c.jsx)(_,{setUser:function(t){ot(t),S(null),T(""),W(!1),f([])}}):Object(c.jsx)(v,{setUser:function(t){ot(t),at()}})]}),C?U?Object(c.jsx)(y,{currentStoryId:C,backToDesk:Et,addSceneCallback:Ct}):Object(c.jsxs)("div",{className:"writing-desk__desk",children:[Object(c.jsx)("div",{className:"writing-desk__editor container border border-dark rounded w-85 h-85",children:Object(c.jsx)(h.Editor,{editorState:n,onChange:Ot,spellCheck:!0})}),Object(c.jsxs)("div",{className:"writing-desk__button-bar d-flex flex-row justify-content-center",children:[Object(c.jsx)("button",{onClick:mt,className:"btn btn-primary rounded m-1",children:"Save"}),Object(c.jsx)("button",{onClick:yt,className:"btn btn-secondary rounded m-1",children:"Add New Scene"}),Object(c.jsx)("button",{onClick:St,className:"btn btn-secondary rounded m-1",children:"Change Title"}),Object(c.jsx)("button",{onClick:ft,className:"btn btn-danger rounded m-1",children:"Delete Story"})]}),Object(c.jsxs)(p.a,{show:M,onHide:wt,animation:!1,backdrop:"static",centered:!0,children:[Object(c.jsx)(p.a.Body,{children:Object(c.jsx)(x.a,{children:Object(c.jsxs)(x.a.Group,{children:[Object(c.jsx)(x.a.Label,{children:"New Title"}),Object(c.jsx)(x.a.Control,{as:"textarea",value:A,onChange:Nt})]})})}),Object(c.jsxs)(p.a.Footer,{children:[Object(c.jsx)(m.a,{variant:"secondary",onClick:wt,children:"Close"}),Object(c.jsx)(m.a,{variant:"primary",onClick:Lt,children:"Save New Title"})]})]})]}):Object(c.jsxs)("div",{className:"story-list",children:[Object(c.jsx)("h3",{className:"story-list__header",children:"What would you like to work on today?"}),ht,Object(c.jsx)("button",{className:"btn story-list__title btn-primary",onClick:ut,children:"Start A New Story"})]}),Object(c.jsxs)(p.a,{show:P,onHide:dt,animation:!1,backdrop:"static",centered:!0,children:[Object(c.jsx)(p.a.Body,{children:Object(c.jsx)(x.a,{children:Object(c.jsxs)(x.a.Group,{children:[Object(c.jsx)(x.a.Label,{children:"What do you want the title of your story to be?"}),Object(c.jsx)(x.a.Control,{as:"textarea",value:A,onChange:bt})]})})}),Object(c.jsx)(p.a.Footer,{children:Object(c.jsx)(m.a,{variant:"primary",onClick:jt,children:"Set Title"})})]}),Object(c.jsxs)(p.a,{show:V,onHide:kt,animation:!1,backdrop:"static",centered:!0,children:[Object(c.jsx)(p.a.Body,{children:Object(c.jsx)(x.a,{children:Object(c.jsxs)(x.a.Group,{children:[Object(c.jsx)(x.a.Label,{children:"What's a quick summary of what happens in this scene?"}),Object(c.jsx)(x.a.Control,{as:"textarea",value:$,onChange:vt})]})})}),Object(c.jsx)(p.a.Footer,{children:Object(c.jsx)(m.a,{variant:"primary",onClick:_t,children:"Make New Scene"})})]})]})},S=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,238)).then((function(e){var n=e.getCLS,c=e.getFID,o=e.getFCP,a=e.getLCP,r=e.getTTFB;n(t),c(t),o(t),a(t),r(t)}))};i.a.render(Object(c.jsx)(a.a.StrictMode,{children:Object(c.jsx)(C,{})}),document.getElementById("root")),S()}},[[236,1,2]]]);
//# sourceMappingURL=main.4faafa28.chunk.js.map